<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <style>
            .candlestick.bull {
                fill: #26a69a;
                stroke: #26a69a;
            }
            .candlestick.bear {
                fill: #ef5350;
                stroke: #ef5350;
            }
            .wick {
                stroke-width: 1;
            }
            .grid-line {
                stroke: #e0e0e0;
                stroke-dasharray: 2, 2;
            }
            .pattern-line {
                stroke: #007bff;
                stroke-width: 2;
                stroke-dasharray: 4, 4;
                fill: none;
            }
            .label-text {
                font-family: 'Arial', 'SimHei', sans-serif;
                font-size: 14px;
                fill: #333;
                font-weight: bold;
            }
            .title-text {
                font-family: 'Arial', 'SimHei', sans-serif;
                font-size: 24px;
                font-weight: bold;
                fill: #2c3e50;
                text-anchor: middle;
            }
            .arrow-line {
                stroke: #2c3e50;
                stroke-width: 1.5;
            }
            .arrow-head {
                fill: #2c3e50;
            }
            .highlight-zone {
                fill: rgba(0, 123, 255, 0.08);
                stroke: none;
            }
        </style>
    </defs>
    
    <!-- Title -->
    <text x="400" y="40" class="title-text">双顶牛旗</text>

    <!-- Grid Lines -->
    <g class="grid">
        <line x1="50" y1="100" x2="750" y2="100" class="grid-line"></line>
        <line x1="50" y1="200" x2="750" y2="200" class="grid-line"></line>
        <line x1="50" y1="300" x2="750" y2="300" class="grid-line"></line>
        <line x1="50" y1="400" x2="750" y2="400" class="grid-line"></line>
    </g>

    <!-- Candlesticks -->
    <g id="candlesticks">
        <!-- Flagpole -->
        <line x1="100" y1="450" x2="100" y2="350" class="wick candlestick bull"></line>
        <rect x="95" y="350" width="10" height="80" class="candlestick bull"></rect>

        <line x1="130" y1="360" x2="130" y2="280" class="wick candlestick bull"></line>
        <rect x="125" y="280" width="10" height="70" class="candlestick bull"></rect>

        <line x1="160" y1="290" x2="160" y2="180" class="wick candlestick bull"></line>
        <rect x="155" y="180" width="10" height="100" class="candlestick bull"></rect>

        <!-- Flag Formation - Double Top inside -->
        <line x1="190" y1="220" x2="190" y2="190" class="wick candlestick bear"></line>
        <rect x="185" y="190" width="10" height="20" class="candlestick bear"></rect>

        <!-- First Top -->
        <line x1="220" y1="185" x2="220" y2="150" class="wick candlestick bull"></line>
        <rect x="215" y="160" width="10" height="25" class="candlestick bull"></rect>
        <line x1="250" y1="180" x2="250" y2="155" class="wick candlestick bear"></line>
        <rect x="245" y="165" width="10" height="15" class="candlestick bear"></rect>

        <!-- Trough -->
        <line x1="280" y1="210" x2="280" y2="180" class="wick candlestick bear"></line>
        <rect x="275" y="180" width="10" height="20" class="candlestick bear"></rect>
        <line x1="310" y1="200" x2="310" y2="175" class="wick candlestick bull"></line>
        <rect x="305" y="180" width="10" height="20" class="candlestick bull"></rect>

        <!-- Second Top -->
        <line x1="340" y1="180" x2="340" y2="152" class="wick candlestick bull"></line>
        <rect x="335" y="158" width="10" height="22" class="candlestick bull"></rect>
        <line x1="370" y1="185" x2="370" y2="160" class="wick candlestick bear"></line>
        <rect x="365" y="168" width="10" height="17" class="candlestick bear"></rect>

        <!-- Before Breakout -->
        <line x1="400" y1="220" x2="400" y2="190" class="wick candlestick bear"></line>
        <rect x="395" y="190" width="10" height="25" class="candlestick bear"></rect>

        <!-- Breakout Candle -->
        <line x1="430" y1="180" x2="430" y2="110" class="wick candlestick bull"></line>
        <rect x="425" y="120" width="10" height="60" class="candlestick bull"></rect>

        <!-- Continuation -->
        <line x1="460" y1="125" x2="460" y2="90" class="wick candlestick bull"></line>
        <rect x="455" y="95" width="10" height="30" class="candlestick bull"></rect>
    </g>

    <!-- Pattern Lines and Labels -->
    <!-- Flagpole Label -->
    <path d="M120,400 Q 150,420 180,400" stroke="#2c3e50" stroke-width="1.5" fill="none" />
    <line x1="150" y1="420" x2="158" y2="300" class="arrow-line"></line>
    <text x="100" y="440" class="label-text">1. 旗杆 (上涨)</text>

    <!-- Flag/Double Top Area -->
    <rect x="175" y="145" width="250" height="85" class="highlight-zone" />
    <line x1="220" y1="150" x2="340" y2="152" class="pattern-line" /> <!-- Top resistance -->
    <line x1="185" y1="210" x2="395" y2="230" class="pattern-line" /> <!-- Bottom support -->

    <text x="180" y="130" class="label-text">2. 旗形盘整 (内含双顶)</text>
    <text x="220" y="140" class="label-text">顶 1</text>
    <text x="335" y="142" class="label-text">顶 2</text>

    <!-- Breakout Label -->
    <circle cx="430" cy="150" r="15" fill="none" stroke="#ef5350" stroke-width="2" />
    <line x1="445" y1="150" x2="520" y2="150" class="arrow-line"></line>
    <polygon points="520,145 530,150 520,155" class="arrow-head" />
    <text x="535" y="155" class="label-text">3. 向上突破</text>

    <!-- Continuation and Prediction -->
    <path d="M500,100 C 520,80, 560,80, 580,100" fill="none" stroke="#2c3e50" stroke-width="1.5"/>
    <line x1="540" y1="80" x2="465" y2="100" class="arrow-line" />
    <text x="500" y="70" class="label-text">4. 趋势继续</text>

    <!-- Predicted Price Movement -->
    <line x1="460" y1="95" x2="650" y2="60" stroke="#00c851" stroke-width="3" stroke-dasharray="8,4" opacity="0.8" />
    <text x="620" y="50" class="label-text" style="font-size: 12px; fill: #00c851;">预测走势</text>

    <!-- Stop Loss Zone (Shadow) -->
    <rect x="430" y="240" width="320" height="260" fill="rgba(255, 68, 68, 0.15)" stroke="none" />
    <line x1="420" y1="240" x2="750" y2="240" stroke="#ff4444" stroke-width="2" stroke-dasharray="6,3" />
    <text x="680" y="235" class="label-text" style="font-size: 12px; fill: #ff4444;">止损区域</text>
    <text x="680" y="250" class="label-text" style="font-size: 10px; fill: #666;">旗形下轨支撑</text>

    <!-- Take Profit Zones (Shadows) -->
    <rect x="430" y="30" width="320" height="90" fill="rgba(76, 175, 80, 0.12)" stroke="none" />
    <line x1="580" y1="30" x2="750" y2="30" stroke="#4caf50" stroke-width="2" stroke-dasharray="6,3" />
    <text x="650" y="25" class="label-text" style="font-size: 12px; fill: #4caf50;">止盈区域1</text>
    <text x="650" y="40" class="label-text" style="font-size: 10px; fill: #666;">旗杆高度1:1</text>

    <rect x="430" y="15" width="320" height="45" fill="rgba(46, 125, 50, 0.18)" stroke="none" />
    <line x1="620" y1="15" x2="750" y2="15" stroke="#2e7d32" stroke-width="2" stroke-dasharray="6,3" />
    <text x="680" y="10" class="label-text" style="font-size: 12px; fill: #2e7d32;">止盈区域2</text>
    <text x="680" y="25" class="label-text" style="font-size: 10px; fill: #666;">旗杆高度1.5:1</text>

    <!-- Optimal Entry Point -->
    <circle cx="430" cy="145" r="8" fill="#ffc107" stroke="#ff8f00" stroke-width="3" />
    <circle cx="430" cy="145" r="12" fill="none" stroke="#ffc107" stroke-width="2" stroke-dasharray="3,2" />
    <text x="445" y="135" class="label-text" style="font-size: 12px; fill: #ff8f00;">最佳买入点</text>
    <text x="445" y="150" class="label-text" style="font-size: 10px; fill: #666;">突破确认后</text>

    <!-- Risk/Reward Analysis -->
    <text x="600" y="300" class="label-text" style="font-size: 12px; fill: #666;">风险收益分析:</text>
    <text x="600" y="320" class="label-text" style="font-size: 11px; fill: #666;">• 风险: 突破点到止损位</text>
    <text x="600" y="335" class="label-text" style="font-size: 11px; fill: #666;">• 收益: 突破点到止盈位</text>
    <text x="600" y="350" class="label-text" style="font-size: 11px; fill: #666;">• 推荐风险收益比: 1:2</text>
</svg>
